[
    {
        "conditions": [
            {
                "mode": "sql_match",
                "expr": {
                    "sql_op": "join",
                    "left": "ORDERS",
                    "right": {
                        "sql_op": "join",
                        "left": "LINEITEM",
                        "right": "CUSTOMER"
                    }
                }
            }
        ],
        "policies": [
            {
                "mode": "filter",
                "expr": {
                    "sql_op": "and",
                    "left": {
                        "op": "<",
                        "left": "LINEITEM.SHIPDATE",
                        "right": "@current_date"
                    },
                    "right": {
                        "op": ">",
                        "left": "LINEITEM.SHIPDATE",
                        "right": {
                            "op": "-",
                            "left": "@current_date",
                            "right": "7"
                        }
                    }
                }
            }
        ]
    },
    {
        "conditions": [
            {
                "mode": "sql_match",
                "expr": {
                    "sql_op": "aggregate"
                }
            }
        ],
        "policies": [
            {
                "mode": "bool_exp",
                "expr": {
                    "op": "=",
                    "left": {
                        "sql_op": "count",
                        "right": {
                            "sql_op": "distinct",
                            "right": "REGION.REGIONKEY"
                        }
                    },
                    "right": 1
                }
            }
        ]
    },
    {
        "conditions": [
            {
                "mode": "sql_match",
                "expr": {
                    "op": "~~"
                }
            }
        ],
        "policies": [
            {
                "mode": "subquery_match",
                "expr":{
                    "op": "~~"
                }
            }
                
        ]
    },
    { 
        "conditions": [
            {
                "mode": "sql_match",
                "expr": {
                    "sql_op": "scan",
                    "right": "SUPPLIER"
                }
            }
        ],
        "policies": [
            {
                "mode": "bool_exp",
                "expr": {
                    "op": "!=",
                    "left": "USERDATA.CUST_KEY",
                    "right": null
                }
            },
            {
                "mode": "bool_exp",
                "expr": {
                    "op": "!=",
                    "left": "USERDATA.SUPP_KEY",
                    "right": null
                }
            }
        ],
        "policies_rel": "or"
    }
]
