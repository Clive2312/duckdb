[
    {
        "conditions": [
            {
                "mode": "sql_match",
                "sql": {
                    "fun": "join",
                    "left_table": "ORDERS",
                    "right_table": {
                        "type": "join",
                        "left_table": "LINEITEM",
                        "right_table": "CUSTOMER"
                    }
                }
            }
        ],
        "policies": [
            {
                "mode": "filter",
                "expr": {
                    "op": "and",
                    "left": {
                        "op": "<",
                        "left": {
                            "literal": "LINEITEM.SHIPDATE"
                        },
                        "right": "@current_date"
                    },
                    "right": {
                        "op": ">",
                        "left": {
                            "literal": "LINEITEM.SHIPDATE"
                        },
                        "right": "@current_date - 7"
                    }
                }
            }
        ]
    },
    {
        "conditions": [
            {
                "mode": "sql_match",
                "sql": {
                    "fun": "aggregate"
                }
            }
        ],
        "policies": [
            {
                "mode": "bool_exp",
                "expr": {
                    "op": "=",
                    "left": {
                        "op": "count",
                        "literal": "REGION.REGIONKEY",
                        "distinct": true
                    },
                    "right": {
                        "literal": 1
                    }
                }
            }
        ]
    },
    {
        "conditions": [
            {
                "mode": "sql_match",
                "sql": {
                    "op": "like"
                }
            }
        ],
        "policies": [
            {
                "mode": "sql_match",
                "sql": {
                    "stm": "subquery",
                    "query":{
                        "op": "like"
                    }
                }
            }
                
        ]
    },
    { 
        "conditions": [
            {
                "mode": "sql_match",
                "sql": {
                    "table": "SUPPLIER"
                }
            }
        ],
        "policies": [
            {
                "mode": "bool",
                "expr": {
                    "op": "!=",
                    "left": {
                        "literal": "USERDATA.CUST_KEY"
                    },
                    "right": {
                        "literal": null
                    }
                }
            },
            {
                "mode": "bool_exp",
                "expr": {
                    "op": "!=",
                    "left": {
                        "literal": "USERDATA.SUPP_KEY"
                    },
                    "right": {
                        "literal": null
                    }
                }
            }
        ],
        "policies_rel": "or"
    }
]
